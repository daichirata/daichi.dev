<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <title>El-get + Flycheckのインストール時のエラー</title>
    <link rel="shortcut icon" href="/assets/images/favicon.ico">
    <link rel="stylesheet" href="/assets/css/main.css">
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.1" />
<meta property="og:title" content="El-get + Flycheckのインストール時のエラー" />
<meta property="og:locale" content="ja_JP" />
<meta name="description" content="最近Emacsの挙動が少し怪しくなってきていた。心当たりはすこしあって、Emacsのバージョンを上げた際に面倒くさくて全てのプラグインをバイトコンパイルし直さなかった。 一旦全てのパッケージを最新にアップデートしたかったこともあり、el-get-dir以下を全て削除してインストールし直した際にflycheckのインストールでエラーが出たのでその時のメモ。" />
<meta property="og:description" content="最近Emacsの挙動が少し怪しくなってきていた。心当たりはすこしあって、Emacsのバージョンを上げた際に面倒くさくて全てのプラグインをバイトコンパイルし直さなかった。 一旦全てのパッケージを最新にアップデートしたかったこともあり、el-get-dir以下を全て削除してインストールし直した際にflycheckのインストールでエラーが出たのでその時のメモ。" />
<link rel="canonical" href="https://daichi.dev/posts/2015-03-27-el-get-flycheck" />
<meta property="og:url" content="https://daichi.dev/posts/2015-03-27-el-get-flycheck" />
<meta property="og:site_name" content="daichi.dev" />
<meta property="og:image" content="https://daichi.dev/assets/images/og.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2015-03-27T00:00:00+09:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://daichi.dev/assets/images/og.png" />
<meta property="twitter:title" content="El-get + Flycheckのインストール時のエラー" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2015-03-27T00:00:00+09:00","datePublished":"2015-03-27T00:00:00+09:00","description":"最近Emacsの挙動が少し怪しくなってきていた。心当たりはすこしあって、Emacsのバージョンを上げた際に面倒くさくて全てのプラグインをバイトコンパイルし直さなかった。 一旦全てのパッケージを最新にアップデートしたかったこともあり、el-get-dir以下を全て削除してインストールし直した際にflycheckのインストールでエラーが出たのでその時のメモ。","headline":"El-get + Flycheckのインストール時のエラー","image":"https://daichi.dev/assets/images/og.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://daichi.dev/posts/2015-03-27-el-get-flycheck"},"url":"https://daichi.dev/posts/2015-03-27-el-get-flycheck"}</script>
<!-- End Jekyll SEO tag -->

  </head>
  <body>
    <header class="mx-4 lg:m-auto lg:w-2/3 py-6 flex items-center justify-between">
      <h1><a href="/" class="text-2xl font-extrabold gradation-text">daichi.dev</a></h1>
      <nav class="flex item-center">
        <a class="pr-4" href="https://twitter.com/daichirata" target="_blank" rel="noopener noreferrer" title="Twitter"><svg height="25" width="25" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z" fill="#454C51"></path></svg></a>
        <a href="https://github.com/daichirata" target="_blank" rel="noopener noreferrer" title="GitHub"><svg height="25" width="25" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z" fill="#454C51"></path></svg></a>
      </nav>
    </header>

    <article class="mx-4 lg:m-auto lg:w-2/3 prose max-w-none">
  <header class="py-8">
    <h1 class="mb-2 text-5xl lg:text-5xl tracking-tight text-black font-extrabold">El-get + Flycheckのインストール時のエラー</h1>
    <time class="tracking-tight text-gray-600 font-semibold" datetime="2015-03-27">2015-03-27</time>
    <span class="mx-4 px-4 py-2 border-l-2 border-gray-300 text-gray-500 font-normal">
      <a href="https://twitter.com/daichirata" class="no-underline">@daichirata</a>
    </span>
  </header>

  <div class="text-xl subpixel-antialiased leading-relaxed break-words content">
    <p>最近Emacsの挙動が少し怪しくなってきていた。心当たりはすこしあって、Emacsのバージョンを上げた際に面倒くさくて全てのプラグインをバイトコンパイルし直さなかった。
一旦全てのパッケージを最新にアップデートしたかったこともあり、el-get-dir以下を全て削除してインストールし直した際にflycheckのインストールでエラーが出たのでその時のメモ。</p>

<h2 id="エラー">エラー</h2>

<p>flycheckのインストールの際に起きたエラー。</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>doc/flycheck.texi:6: 警告: unrecognized encoding name <span class="sb">`</span>UTF-8<span class="s1">'.
doc/flycheck.texi:86: @pxref expected braces.
doc/flycheck.texi:86: ` {Installation}
and @ref{Quickstart} res...'</span> is too long <span class="k">for </span>expansion<span class="p">;</span> not expanded.
doc/flycheck.texi:86: First argument to cross-reference may not be empty.
./doc/flycheck.texi:75: 次 reference to nonexistent node <span class="sb">`</span>Introduction<span class="s1">' (perhaps incorrect sectioning?).
./doc/flycheck.texi:85: 相互 reference to nonexistent node `Introduction'</span> <span class="o">(</span>perhaps incorrect sectioning?<span class="o">)</span><span class="nb">.</span>
makeinfo: エラーにより、出力ファイル <span class="sb">`</span>doc/flycheck.info<span class="s1">' を削除します。
       -- 残したい場合には `--force'</span> オプションを使ってください。
</code></pre></div></div>

<p>軽く調べてみた感じだと<a href="https://github.com/flycheck/flycheck/issues/299">https://github.com/flycheck/flycheck/issues/299</a>にある通り、texinfoのバージョンが古いと発生する模様。エラーとなるコマンドは</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>makeinfo <span class="nt">-o</span> doc/flycheck.info doc/flycheck.texi
</code></pre></div></div>

<p>で、OSX10.10の標準のmakeinfoは4.8らしい。</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>makeinfo <span class="nt">--version</span>
makeinfo <span class="o">(</span>GNU texinfo<span class="o">)</span> 4.8

Copyright <span class="o">(</span>C<span class="o">)</span> 2004 Free Software Foundation, Inc.
There is NO warranty.  You may redistribute this software
under the terms of the GNU General Public License.
For more information about these matters, see the files named COPYING.
</code></pre></div></div>

<h2 id="インストール">インストール</h2>

<p>とりあえず、Homebrewで新しいtexinfoをインストールするべし。</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>brew info texinfo
texinfo: stable 5.2 <span class="o">(</span>bottled<span class="o">)</span>
http://www.gnu.org/software/texinfo/

This formula is keg-only.
Mac OS X already provides this software and installing another version <span class="k">in
</span>parallel can cause all kinds of trouble.

Software that uses TeX, such as lilypond and octave, require a newer versqion
of these files.

/usr/local/Cellar/texinfo/5.2 <span class="o">(</span>396 files, 8.1M<span class="o">)</span>
  Poured from bottle
From: https://github.com/Homebrew/homebrew/blob/master/Library/Formula/texinfo.rb

<span class="nv">$ </span>brew <span class="nb">install </span>texinfo
</code></pre></div></div>

<p>texinfoは標準でOSXにインストールされているパッケージなので<code class="language-plaintext highlighter-rouge">--force</code>を付けてlinkする。</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>brew <span class="nb">link</span> <span class="nt">--force</span> texinfo
</code></pre></div></div>

<p>後は、再びインストールすれば問題ない・・・が、自分の環境ではもう少し問題ががが。</p>

<h2 id="emacs-path問題">Emacs PATH問題</h2>

<p>OSXでEmacs(GUI版)を起動した際に<a href="http://qiita.com/catatsuy/items/3dda714f4c60c435bb25">EmacsでPATHの設定が引き継がれない問題をエレガントに解決する</a>の様な問題がある。</p>

<p>私の場合は<a href="https://github.com/purcell/exec-path-from-shell">exec-path-from-shell</a>というパッケージを利用してこの問題を解決していたが、このパッケージ自体もel-getで管理していたためflycheckのインストール中にはまだロードされていなかった。</p>

<p>なので、PATH問題の解決にexec-path-from-shellを使うのをやめ、上のQiitaにある関数を定義した。</p>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nb">defun</span> <span class="nv">set-exec-path-from-shell-PATH</span> <span class="p">()</span>
  <span class="s">"Set up Emacs' `exec-path' and PATH environment variable to match that used by the user's shell.

This is particularly useful under Mac OSX, where GUI apps are not started from a shell."</span>
  <span class="p">(</span><span class="nv">interactive</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">path-from-shell</span> <span class="p">(</span><span class="nv">replace-regexp-in-string</span> <span class="s">"[ \t\n]*$"</span> <span class="s">""</span> <span class="p">(</span><span class="nv">shell-command-to-string</span> <span class="s">"$SHELL --login -i -c 'echo $PATH'"</span><span class="p">))))</span>
    <span class="p">(</span><span class="nv">setenv</span> <span class="s">"PATH"</span> <span class="nv">path-from-shell</span><span class="p">)</span>
    <span class="p">(</span><span class="k">setq</span> <span class="nv">exec-path</span> <span class="p">(</span><span class="nv">split-string</span> <span class="nv">path-from-shell</span> <span class="nv">path-separator</span><span class="p">))))</span>

<span class="p">(</span><span class="nv">set-exec-path-from-shell-PATH</span><span class="p">)</span>
</code></pre></div></div>

<p>後はこの関数をel-getの初期化の前に呼んであげれば無事インストールできると思う。</p>

  </div>
</article>


    <script async src="https://www.googletagmanager.com/gtag/js?id=G-W9BS0Z0NPD"></script>
<script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());
 gtag('config', 'G-W9BS0Z0NPD');
</script>

  </body>
</html>
